<!DOCTYPE HTML>
<!--
    Astral by HTML5 UP
    html5up.net | @ajlkn
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
<head>
    <title>Astral by HTML5 UP</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
    <link href="assets/css/stylesheetMobile.css" rel="stylesheet" />

    <script src="scripts/jquery-3.4.1.min.js"></script>
    <script src="scripts/config.js"></script>
    <link rel="stylesheet" href="assets/css/alan.css" />
    <link rel="stylesheet" href="assets/css/animate.css" />
    <style>
        #mydiv {
            position: absolute;
            z-index: 9;
            background-color: #000;
            text-align: center;
            border: 1px solid #d3d3d3;
        }

        #mydivheader {
            padding: 10px;
            cursor: move;
            z-index: 10;
            background-color: #2196F3;
            color: #fff;
        }
    </style>

    <script>

        var AllOrg;
        var selectedCardId = -1;
        var selectedCardVersion = -1;
        var selectedPosition = -1;
        var position=90;
            
            function plusminus(id){
                //$(".side").removeClass("minus");
                //$(".side").addClass("plus");
                if ($("#"+id).hasClass("minus")){
                    $("#"+id).removeClass("minus");
                    $("#"+id).addClass("plus");
                    $("#sidesASelect").hide();

                }else{
                    $("#"+id).addClass("minus");
                    $("#"+id).removeClass("plus");
                    $("#sidesASelect").show();
                }
            }

            function blindClick(id){
                if ($("#"+id).hasClass("blindSelected")){
                    $("#"+id).removeClass("blindSelected");
                    $(".blindDetail").hide();
                }else{
                    $("#"+id).addClass("blindSelected");
                    $(".blindDetail").show();
                }
            }
        $(document).ready(function () {
            //LoadAllData();
            $("#blindExample").addClass("position"+position);
            var wow = new WOW({
                boxClass:     'wow',      // animated element css class (default is wow)
                animateClass: 'animated', // animation css class (default is animated)
                offset:       0,          // distance to the element when triggering the animation (default is 0)
                mobile:       true,       // trigger animations on mobile devices (default is true)
                live:         true,       // act on asynchronously loaded content (default is true)
                callback:     function(box) {
                // the callback is fired every time an animation is started
                // the argument that is passed in is the DOM node being animated
                },
                scrollContainer: null,    // optional scroll container selector, otherwise use window,
                resetAnimation: true,     // reset animation on end (default is true)
            });
            new WOW().init();
        });

        function LoadAllData() {

            
           AllOrg = [{"FldFullPathName":"בנק לאומי-\u003eקומה 2","GroupName":"חברה אילן","FldGroupId":16,"FldOrgId":6609,"FldOrgDisplayName":"קומה 2","fldOrgTypeId":0,"OrgFullPathName":"בנק לאומי-\u003eקומה 2","FldLevel":1,"FldParentId":1,"innerrLevel":1,"UIId":"6609_6609","WorkingMode":"A","CardId":null,"Position":0,"CardStatusId":null,"CardStatusDisplayName":null,"FldVersion":null},{"FldFullPathName":"בנק לאומי-\u003eקומה 3","GroupName":"חברה אילן","FldGroupId":16,"FldOrgId":6610,"FldOrgDisplayName":"קומה 3","fldOrgTypeId":0,"OrgFullPathName":"בנק לאומי-\u003eקומה 3","FldLevel":1,"FldParentId":1,"innerrLevel":1,"UIId":"6610_6610","WorkingMode":"A","CardId":null,"Position":0,"CardStatusId":null,"CardStatusDisplayName":null,"FldVersion":null},{"FldFullPathName":"בנק לאומי-\u003eקומה 3-\u003eחזית מערבית","GroupName":"חברה אילן","FldGroupId":16,"FldOrgId":6859,"FldOrgDisplayName":"חזית מערבית","fldOrgTypeId":0,"OrgFullPathName":"בנק לאומי-\u003eקומה 3-\u003eחזית מערבית","FldLevel":2,"FldParentId":6610,"innerrLevel":2,"UIId":"6610_6859","WorkingMode":"A","CardId":null,"Position":0,"CardStatusId":null,"CardStatusDisplayName":null,"FldVersion":null},{"FldFullPathName":"בנק לאומי-\u003eקומה 2-\u003eחזית מערבית","GroupName":"חברה אילן","FldGroupId":16,"FldOrgId":6858,"FldOrgDisplayName":"חזית מערבית","fldOrgTypeId":0,"OrgFullPathName":"בנק לאומי-\u003eקומה 2-\u003eחזית מערבית","FldLevel":2,"FldParentId":6609,"innerrLevel":2,"UIId":"6609_6858","WorkingMode":"A","CardId":null,"Position":0,"CardStatusId":null,"CardStatusDisplayName":null,"FldVersion":null},{"FldFullPathName":"בנק לאומי-\u003eקומה 2-\u003eחזית מערבית-\u003eוילון 2A1","GroupName":"חברה אילן","FldGroupId":16,"FldOrgId":6614,"FldOrgDisplayName":"וילון 2A1","fldOrgTypeId":3,"OrgFullPathName":"בנק לאומי-\u003eקומה 2-\u003eחזית מערבית-\u003eוילון 2A1","FldLevel":3,"FldParentId":6858,"innerrLevel":3,"UIId":"6609_6614","WorkingMode":"A","CardId":2061,"Position":255,"CardStatusId":1,"CardStatusDisplayName":"לא מקושר","FldVersion":1},{"FldFullPathName":"בנק לאומי-\u003eקומה 2-\u003eחזית מערבית-\u003eוילון 2A2","GroupName":"חברה אילן","FldGroupId":16,"FldOrgId":6615,"FldOrgDisplayName":"וילון 2A2","fldOrgTypeId":3,"OrgFullPathName":"בנק לאומי-\u003eקומה 2-\u003eחזית מערבית-\u003eוילון 2A2","FldLevel":3,"FldParentId":6858,"innerrLevel":3,"UIId":"6609_6615","WorkingMode":"A","CardId":2180,"Position":0,"CardStatusId":1,"CardStatusDisplayName":"לא מקושר","FldVersion":1},{"FldFullPathName":"בנק לאומי-\u003eקומה 2-\u003eחזית מערבית-\u003eוילון 2A3","GroupName":"חברה אילן","FldGroupId":16,"FldOrgId":6616,"FldOrgDisplayName":"וילון 2A3","fldOrgTypeId":3,"OrgFullPathName":"בנק לאומי-\u003eקומה 2-\u003eחזית מערבית-\u003eוילון 2A3","FldLevel":3,"FldParentId":6858,"innerrLevel":3,"UIId":"6609_6616","WorkingMode":"A","CardId":2176,"Position":0,"CardStatusId":1,"CardStatusDisplayName":"לא מקושר","FldVersion":1},{"FldFullPathName":"בנק לאומי-\u003eקומה 2-\u003eחזית מערבית-\u003eוילון 2A4","GroupName":"חברה אילן","FldGroupId":16,"FldOrgId":6617,"FldOrgDisplayName":"וילון 2A4","fldOrgTypeId":3,"OrgFullPathName":"בנק לאומי-\u003eקומה 2-\u003eחזית מערבית-\u003eוילון 2A4","FldLevel":3,"FldParentId":6858,"innerrLevel":3,"UIId":"6609_6617","WorkingMode":"A","CardId":2064,"Position":54,"CardStatusId":1,"CardStatusDisplayName":"לא מקושר","FldVersion":1},{"FldFullPathName":"בנק לאומי-\u003eקומה 2-\u003eחזית מערבית-\u003eוילון 2A5","GroupName":"חברה אילן","FldGroupId":16,"FldOrgId":6618,"FldOrgDisplayName":"וילון 2A5","fldOrgTypeId":3,"OrgFullPathName":"בנק לאומי-\u003eקומה 2-\u003eחזית מערבית-\u003eוילון 2A5","FldLevel":3,"FldParentId":6858,"innerrLevel":3,"UIId":"6609_6618","WorkingMode":"A","CardId":2175,"Position":0,"CardStatusId":1,"CardStatusDisplayName":"לא מקושר","FldVersion":1},{"FldFullPathName":"בנק לאומי-\u003eקומה 2-\u003eחזית מערבית-\u003eוילון 2A6","GroupName":"חברה אילן","FldGroupId":16,"FldOrgId":6619,"FldOrgDisplayName":"וילון 2A6","fldOrgTypeId":3,"OrgFullPathName":"בנק לאומי-\u003eקומה 2-\u003eחזית מערבית-\u003eוילון 2A6","FldLevel":3,"FldParentId":6858,"innerrLevel":3,"UIId":"6609_6619","WorkingMode":"A","CardId":2062,"Position":0,"CardStatusId":1,"CardStatusDisplayName":"לא מקושר","FldVersion":1},{"FldFullPathName":"בנק לאומי-\u003eקומה 3-\u003eחזית מערבית-\u003eוילון 3A1","GroupName":"חברה אילן","FldGroupId":16,"FldOrgId":6660,"FldOrgDisplayName":"וילון 3A1","fldOrgTypeId":3,"OrgFullPathName":"בנק לאומי-\u003eקומה 3-\u003eחזית מערבית-\u003eוילון 3A1","FldLevel":3,"FldParentId":6859,"innerrLevel":3,"UIId":"6610_6660","WorkingMode":"A","CardId":2336,"Position":0,"CardStatusId":1,"CardStatusDisplayName":"לא מקושר","FldVersion":1},{"FldFullPathName":"בנק לאומי-\u003eקומה 3-\u003eחזית מערבית-\u003eוילון 3A2","GroupName":"חברה אילן","FldGroupId":16,"FldOrgId":6661,"FldOrgDisplayName":"וילון 3A2","fldOrgTypeId":3,"OrgFullPathName":"בנק לאומי-\u003eקומה 3-\u003eחזית מערבית-\u003eוילון 3A2","FldLevel":3,"FldParentId":6859,"innerrLevel":3,"UIId":"6610_6661","WorkingMode":"A","CardId":2217,"Position":0,"CardStatusId":1,"CardStatusDisplayName":"לא מקושר","FldVersion":1},{"FldFullPathName":"בנק לאומי-\u003eקומה 3-\u003eחזית מערבית-\u003eוילון 3A3","GroupName":"חברה אילן","FldGroupId":16,"FldOrgId":6662,"FldOrgDisplayName":"וילון 3A3","fldOrgTypeId":3,"OrgFullPathName":"בנק לאומי-\u003eקומה 3-\u003eחזית מערבית-\u003eוילון 3A3","FldLevel":3,"FldParentId":6859,"innerrLevel":3,"UIId":"6610_6662","WorkingMode":"A","CardId":2219,"Position":0,"CardStatusId":1,"CardStatusDisplayName":"לא מקושר","FldVersion":1},{"FldFullPathName":"בנק לאומי-\u003eקומה 3-\u003eחזית מערבית-\u003eוילון 3A4","GroupName":"חברה אילן","FldGroupId":16,"FldOrgId":6663,"FldOrgDisplayName":"וילון 3A4","fldOrgTypeId":3,"OrgFullPathName":"בנק לאומי-\u003eקומה 3-\u003eחזית מערבית-\u003eוילון 3A4","FldLevel":3,"FldParentId":6859,"innerrLevel":3,"UIId":"6610_6663","WorkingMode":"A","CardId":2238,"Position":0,"CardStatusId":1,"CardStatusDisplayName":"לא מקושר","FldVersion":1},{"FldFullPathName":"בנק לאומי-\u003eקומה 3-\u003eחזית מערבית-\u003eוילון 3A5","GroupName":"חברה אילן","FldGroupId":16,"FldOrgId":6664,"FldOrgDisplayName":"וילון 3A5","fldOrgTypeId":3,"OrgFullPathName":"בנק לאומי-\u003eקומה 3-\u003eחזית מערבית-\u003eוילון 3A5","FldLevel":3,"FldParentId":6859,"innerrLevel":3,"UIId":"6610_6664","WorkingMode":"A","CardId":2241,"Position":0,"CardStatusId":1,"CardStatusDisplayName":"לא מקושר","FldVersion":1},{"FldFullPathName":"בנק לאומי-\u003eקומה 3-\u003eחזית מערבית-\u003eוילון 3A6","GroupName":"חברה אילן","FldGroupId":16,"FldOrgId":6665,"FldOrgDisplayName":"וילון 3A6","fldOrgTypeId":3,"OrgFullPathName":"בנק לאומי-\u003eקומה 3-\u003eחזית מערבית-\u003eוילון 3A6","FldLevel":3,"FldParentId":6859,"innerrLevel":3,"UIId":"6610_6665","WorkingMode":"A","CardId":2237,"Position":0,"CardStatusId":1,"CardStatusDisplayName":"לא מקושר","FldVersion":1}];

            for (var i = 0; i < AllOrg.length; i++) {
                if (AllOrg[i].innerrLevel === 1)
                    LoadOrg(0, AllOrg[i].FldParentId, AllOrg[i].FldOrgId);
            }
            return;
          

            var Name = 'OrgGetAll';

            $.ajax({
                type: "POST",
                url: serverAddress + "UISM.aspx/Getts",
                data: JSON.stringify({
                    'Name': Name, 'Params': 'FldUserId,1'
                }),
                async: false,

                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (data) {
                    debugger;
                    AllOrg = JSON.parse(data.d).result_name;
                    for (var i = 0; i < AllOrg.length; i++) {
                        if (AllOrg[i].innerrLevel === 1)
                            LoadOrg(0, AllOrg[i].FldParentId, AllOrg[i].FldOrgId);
                    }

                },
                error: function (x, y, z) {
                    alert('GetOrgType.' + x.responseText + "  " + x.status);
                }
            });
        }

        function LoadOrg(level, ParentId, MainParentId) {
            //debugger;
            // If First  time create all Main Nodes
            if (level === 0) {
                AddDiv('DivAll', 'DivAll-' + MainParentId + '_' + ParentId, 'BRUnderLine', 'background-color: rgb(239, 239, 239)', '');
                //AddDiv('DivAll-' + MainParentId + '_' + ParentId, 'DivAllS-' + MainParentId + '_' + ParentId, 'icon solid fa-minus-circle BRCollapse', '', '', 'ColCell(this);');
                //AddDiv('DivAll-' + MainParentId + '_' + ParentId, 'DivAll-' + MainParentId + '_' + ParentId + 'Title', 'BRTitle', '', AllOrg[0].GroupName, '');
            }

            for (var i = 0; i < AllOrg.length; i++) {
                if (AllOrg[i].FldParentId === ParentId)

                    if (AllOrg[i].UIId == MainParentId + '_' + AllOrg[i].FldOrgId) {
                        var color = 255 - (level + 1) * 16;
                        var NewId = MainParentId + '_' + AllOrg[i].FldOrgId;
                        var OrgId = AllOrg[i].FldOrgId;
                        var Position = AllOrg[i].Position;
                        var CardId = AllOrg[i].CardId;


                        var ShowCollapseIcon;
                        var DisplayName;
                        var BlindTitleAction='';

                        // If Blind
                        if (AllOrg[i].fldOrgTypeId === 3) {
                            ShowCollapseIcon = '';
                        }
                        else {
                            ShowCollapseIcon = 'icon solid fa-minus-circle BRCollapse';
                        }

                        if (AllOrg[i].CardId !== null) {
                            DisplayName = AllOrg[i].FldOrgDisplayName + '(' + AllOrg[i].WorkingMode + '*)';
                            BlindTitleAction = 'ShowBlind(' + AllOrg[i].CardId + ',' + AllOrg[i].FldVersion + ',' + AllOrg[i].Position +');';
                        }
                        else
                        {
                            DisplayName = AllOrg[i].FldOrgDisplayName;
                        }


                        AddDiv('DivAll-' + MainParentId + '_' + ParentId, 'DivAll-' + NewId, 'BRUnderLine', 'background-color: rgb(' + color + ', ' + color + ', ' + color + ')', '', '');
                        AddDiv('DivAll-' + NewId, 'DivAllS-' + NewId,  ShowCollapseIcon, '', '', 'ColCell(this);');
                        AddDiv('DivAll-' + NewId, 'DivAllT-' + NewId, 'BRTitle', '', DisplayName, BlindTitleAction);

                        // If Status Active Add Action Buttons
                        if (AllOrg[i].CardId !== null) {
                            // draw window + buttons
                            // Main Window Div
                            AddDiv('DivAll-' + NewId, 'DivAllMainActionDiv-' + NewId, 'BRBlind2', '', '', '');

                            // Button UP
                            AddDiv('DivAllMainActionDiv-' + NewId, 'DivAllActionDivUp-' + NewId, 'icon solid fa-chevron-circle-up BRBlind2SmallDetailsIconUp', '', '', 'SmallBlindChangePosition(-10, ' + CardId+ ');');

                            // Title
                            AddDiv('DivAllMainActionDiv-' + NewId, 'DivAllMainActionDivWindow-' + NewId, 'BRTitlePos', '', '', '');

                            // Windows Blind
                            AddDiv('DivAllMainActionDivWindow-' + NewId, 'DivAllMainActionDivWindowShow-' + NewId, 'Blind2SmallShow', ' background: linear-gradient(#b488d8 ' + Position + '%, white ' + Position + '%);', '', '');

                            // Blind Position
                            AddDiv('DivAllMainActionDivWindow-' + NewId, 'DivAllMainActionDivWindowTitle-' + NewId, 'BRTitlePos', 'position:absolute', Position + '%', '');

                            //ButtonDown
                            AddDiv('DivAllMainActionDiv-' + NewId, 'DivAllActionDivDown-' + NewId, 'icon solid fa-chevron-circle-down BRBlind2SmallDetailsIconUp', '', '', 'SmallBlindChangePosition(10 , ' + CardId + ');');



                            // If error Present Icon
                            if (AllOrg[i].CardStatusId !== 2) {

                                AddDiv('DivAll-' + NewId, 'DivAllActionError-' + NewId, 'icon solid fa-exclamation-triangle BRBlind2exclamation', 'font-size:17px;top:-20px', '', 'alert(\'' + AllOrg[i].CardStatusId.toString() + ' - תקלה תקשורת לכרטיס\');');

                            }
                        }





                        LoadOrg(level + 1, AllOrg[i].FldOrgId, MainParentId);
                    }
            }
        }

        function UpdateData() {

            var Name = 'OrgGetAll';

            $.ajax({
                type: "POST",
                url: serverAddress + "UISM.aspx/Getts",
                data: JSON.stringify({
                    'Name': Name, 'Params': 'FldUserId,1'
                }),
                async: false,

                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (data) {
                    AllOrg = JSON.parse(data.d).result_name;

                    LoadOrgUpdateValues();

                },
                error: function (x, y, z) {
                    alert('GetOrgType.' + x.responseText + "  " + x.status);
                }
            });
        }
        function LoadOrgUpdateValues() {
            for (var i = 0; i < AllOrg.length; i++) {
                var NewId = AllOrg[i].UIId;
                var CorrPosition = AllOrg[i].Position;
                
                // this line deletes the inner div so we need to add it again
                if (AllOrg[i].CardId !== null) {
                    document.getElementById('DivAllMainActionDivWindowTitle-' + NewId).innerText = CorrPosition + '%';
                    document.getElementById('DivAllMainActionDivWindowShow-' + NewId).style.background = 'linear-gradient(#b488d8 ' + CorrPosition + '% , white ' + CorrPosition + '%)';
                }
            }
        }

        function ColCell(obj) {
            //debugger;
            if (obj.className === "icon solid fa-minus-circle BRCollapse") {
                obj.className = "icon solid fa-plus-circle BRExpende";
                for (var i = 2; i < obj.parentElement.children.length; i++)
                    obj.parentElement.children[i].style.display = 'none';
            }
            else
                if (obj.className === "icon solid fa-plus-circle BRExpende") {
                    obj.className = "icon solid fa-minus-circle BRCollapse";
                    for (var i = 2; i < obj.parentElement.children.length; i++)
                        obj.parentElement.children[i].style.display = 'block';
                }

        }

        function AddDiv(OldDivId, NewDivId, className, style, Title, onclicks) {
            var NewDiv = document.createElement("div");

            if (NewDivId != '')
                NewDiv.setAttribute("Id", NewDivId);

            if (className != '')
                NewDiv.setAttribute("class", className);

            if (style != '')
                NewDiv.setAttribute("style", style);

            if (Title != '')
                NewDiv.innerText = Title;

            if (onclicks != '')
                NewDiv.setAttribute("onclick", onclicks);



            document.getElementById(OldDivId).appendChild(NewDiv);
        }

        function FilterData() {
            //alert(document.getElementById('TxtSearch').value);

            // Hide All
            HideAllDivToDown();

            // If child is shown = show parents to top
            var FilterText = document.getElementById('TxtSearch').value.toLowerCase();
            for (var i = 0; i < AllOrg.length; i++) {
                if (AllOrg[i].FldOrgDisplayName.toLowerCase().indexOf(FilterText) !== -1) {
                    ShowDivsUp(document.getElementById('DivAll-' + AllOrg[i].UIId));
                    ShowDivsDown(document.getElementById('DivAll-' + AllOrg[i].UIId));
                }

            }
        }

        function HideAllDivToDown() {
            for (var i = 0; i < AllOrg.length; i++)
                document.getElementById('DivAll-' + AllOrg[i].UIId).style.display = 'none';
        }

        function ShowDivsUp(MyDiv) {
            MyDiv.style.display = 'block';
            while (MyDiv.parentElement.id !== 'DivAll') {
                MyDiv = MyDiv.parentElement;
                MyDiv.style.display = 'block';
            }
        }

        function ShowDivsDown(MyDiv) {
            MyDiv.style.display = 'block';
            for (var i = 0; i < MyDiv.children.length; i++) {
                if (MyDiv.children[i].id.indexOf('DivAll-') !== -1)
                    ShowDivsDown(MyDiv.children[i]);
            }
        }

        function ShowBlind(Id, version, Position) {
            //debugger;
            selectedCardId = Id;
            selectedCardVersion = version;
            selectedPosition = Position;
            var i = 0;
            while (AllOrg[i].CardId !== Id)
                i++;

            document.getElementById('DivBlindDetailTitle').innerText = AllOrg[i].OrgFullPathName + '(' + AllOrg[i].WorkingMode + '-)';
            PresentBigBlindPosition(AllOrg[i].Position);
            document.getElementById('BlindDetailsLink').click();

            if (AllOrg[i].CardStatusId !== 2) {
                document.getElementById('DivBlindDetailErrorContainer').style.display = 'block';
                document.getElementById('DivBlindDetailErrorText').innerText = AllOrg[i].CardStatusDisplayName;
            }
            else {
                document.getElementById('DivBlindDetailErrorContainer').style.display = 'none';


            }
                
        }

        function PresentBigBlindPosition(CurPer) {

            if (CurPer > 100)
                CurPer = 100;

            if (CurPer < 0)
                CurPer = 0;


            document.getElementById("DivMyHeightBackground").style.height = ((CurPer * 195) / 100) + 'px';
            document.getElementById("DivMyHeightShow").innerText = CurPer + '%';
            document.getElementById("mydiv").style.top = 70+((CurPer*165)/100) + 'px';
        }

        function SmallBlindChangePosition(Move, CardId) {



            var CorrPosition = -1;
            // Find corrent positoin
            for (var i = 0; i < AllOrg.length; i++)
                if (AllOrg[i].CardId === CardId) {

                    /*if (AllOrg[i].CardStatusId !== 2) {
                        alert('לא ניתן לבצע פעולות בוילון זה עקב תקלה.');
                        return;
                    }*/


                    CorrPosition = AllOrg[i].Position;
                }
            

            // Set new Position
            CorrPosition = CorrPosition + Move;
            
            if (CorrPosition > 100)
                CorrPosition = 100;

            if (CorrPosition < 0)
                CorrPosition = 0;

            var LastIndexId = -1;
            // Update All windows + local object
            for (var i = 0; i < AllOrg.length; i++)
                if (AllOrg[i].CardId === CardId) 
                {
                    var NewId = AllOrg[i].UIId;
                    // this line deletes the inner div so we need to add it again
                    document.getElementById('DivAllMainActionDivWindowTitle-' + NewId).innerText = CorrPosition + '%';
                    document.getElementById('DivAllMainActionDivWindowShow-' + NewId).style.background = 'linear-gradient(#b488d8 ' + CorrPosition + '% , white ' + CorrPosition + '%)'; 

                    AllOrg[i].Position = CorrPosition;

                    LastIndexId = i;
                }

            // Send Command
            ActivateDevice(3, 4, AllOrg[LastIndexId].FldVersion, AllOrg[LastIndexId].CardId, ';FldBlindPositionUser,' + CorrPosition  );
        }

        function ActivateDevice(_OrgTypeId, FuncId, version, FldId, ExtraParam) {
            ////////debugger;
            var Name = 'TblZOrgType' + _OrgTypeId + 'F' + FuncId + 'V' + version + 'Activate';
            //debugger;
            var param = 'FldId,' + FldId + ExtraParam;
            $.ajax({
                type: "POST",
                url: serverAddress + "UIS.aspx/Getts",
                data: JSON.stringify({
                    'Name': Name, 'Params': param
                }),
                async: false,

                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (data) {
                    //GetTBL1();
                },
                error: function (x, y, z) {
                    alert('GetOrgType.' + x.responseText + "  " + x.status);
                }
            });

        }

        function ChangeBigBlindPosition(Val) {
            //debugger;
            selectedPosition = selectedPosition + Val;
            if (selectedPosition < 0)
                selectedPosition = 0;
            if (selectedPosition > 100)
                selectedPosition =100;

            PresentBigBlindPosition(selectedPosition);

            // Send Command
            ActivateDevice(3, 4, selectedCardVersion, selectedCardId, ';FldBlindPositionUser,' + selectedPosition);
        }
    </script>

</head>
<body class="is-preload" dir="rtl">
    <div class="header"></div>
    <a href="#home2" id="BlindDetailsLink"></a>


    <!-- Wrapper-->
    <div id="wrapper">

        <!-- Nav -->
        <nav id="nav">
            <a href="#" class="icon-alan icon-home"></a>
            <a href="#contact" class="icon solid fa-envelope"></a>
            <a href="#Login" class="icon solid fa-user-circle"></a>
            <a href="#Rules" class="icon solid fa-list"></a>
        </nav>

        <!-- Main -->
        <div id="main">

            <!-- home -->
            <article id="home" class="panel intro" style="height:100%">
                <div id="DivSearch">
                    <div class="icon solid fa-sync-alt refresh" onclick="UpdateData()"></div>
                    <div id="DivSearchBox">
                        <div class="icon solid fa-search"></div>
                        <input id="TxtSearch" onkeyup="FilterData();" type="text" />
                    </div>
                </div>
                <div class="container" style="width:100%">
                    <div class="sides">
                        <a id="sideA" class="side plus" style="float: right;" href="#" onclick="plusminus('sideA'); return false;">קומה 2</a>
                        <select name="sidesASelect" id="sidesASelect">
                            <option value="1">Side A</option>
                            <option value="2">Side B</option>
                            <option value="3">Side C</option>
                            <option value="4">Side D</option>
                        </select>
                    </div>

                    <div class="DivAll">
                        <div id="blindExample" class="blindContent wow fadeInUp center">
                            <div class="blind position90">
                                <div class="stateBlind"></div>
                            </div>
                            <div class="divPercent">90%</div>
                            <div class="blindSection">
                                <div class="blindName">2A3 GFR 7854</div>
                                <div class="blindNameSection">וילון</div>
                                <div class="blindLetterSection">A2FD&934</div>
                            </div>
                        </div>
                        <div class="blindDetail hide wow fadeInUp center">
                            <div id="blindpopPosition">
                                90%
                            </div>
                            <div id="blindDetailContent">
                                <div class="blindpop">
                                    <div class="blindContentpop">
                                        <div class="blind-row"></div>
                                        <div class="blind-row"></div>
                                        <div class="blind-row"></div>
                                        <div class="blind-row"></div>
                                        <div class="blind-row"></div>
                                        <div class="blind-row"></div>
                                        <div class="blind-row"></div>
                                        <div class="blind-row"></div>
                                        <div class="blind-row"></div>
                                        <div class="blind-row"></div>
                                    </div>
                                </div>
                                <div class="range-slider" style="position: absolute;top: 93px;left: -76px;">
                                    <input id="slidePosition" class="input-range" type="range" step="1" value="0" min="1" max="101">
                                </div> 
                                <div class="range-slider" style="position: absolute;top: 93px;right: -76px;">
                                    <input id="slideAngle" class="input-range" type="range" step="1" value="0" min="1" max="100">
                                </div> 
                            </div>
                        </div>
                        <div class="blindContent wow fadeInUp center">
                            <div class="blind position70">
                                <div class="stateBlind"></div>
                            </div>
                            <div class="divPercent">70%</div>
                            <div class="blindSection">
                                <div class="blindName">2A3 GFR 7854</div>
                                <div class="blindNameSection">וילון</div>
                                <div class="blindLetterSection">A2FD&934</div>
                            </div>
                        </div>
                        <div class="blindContent wow fadeInUp center">
                            <div class="blind position90">
                                <div class="stateBlind"></div>
                            </div>
                            <div class="divPercent">90%</div>
                            <div class="blindSection">
                                <div class="blindName">2A3 GFR 7854</div>
                                <div class="blindNameSection">וילון</div>
                                <div class="blindLetterSection">A2FD&934</div>
                            </div>
                        </div>
                        <div class="blindContent error wow fadeInUp center">
                            <div class="blind position50">
                                <div class="stateBlind"></div>
                            </div>
                            <div class="divPercent">50%</div>
                            <div class="blindSection">
                                <div class="blindName">2A3 GFR 7854</div>
                                <div class="blindNameSection">וילון</div>
                                <div class="blindLetterSection">A2FD&934</div>
                            </div>
                        </div>
                        <div class="blindContent wow fadeInUp center">
                            <div class="blind position30">
                                <div class="stateBlind"></div>
                            </div>
                            <div class="divPercent">30%</div>
                            <div class="blindSection">
                                <div class="blindName">2A3 GFR 7854</div>
                                <div class="blindNameSection">וילון</div>
                                <div class="blindLetterSection">A2FD&934</div>
                            </div>
                        </div>
                        <div class="blindContent error wow fadeInUp center">
                            <div class="blind position90">
                                <div class="stateBlind"></div>
                            </div>
                            <div class="divPercent">90%</div>
                            <div class="blindSection">
                                <div class="blindName">2A3 GFR 7854</div>
                                <div class="blindNameSection">וילון</div>
                                <div class="blindLetterSection">A2FD&934</div>
                            </div>
                        </div>
                        <div class="blindContent error wow fadeInUp center">
                            <div class="blind position10">
                                <div class="stateBlind"></div>
                            </div>
                            <div class="divPercent">10%</div>
                            <div class="blindSection">
                                <div class="blindName">2A3 GFR 7854</div>
                                <div class="blindNameSection">וילון</div>
                                <div class="blindLetterSection">A2FD&934</div>
                            </div>
                        </div>
                    </div>
                </div>
            </article>

            <!-- home2 -->
            <article id="home2" class="panel intro" style="height:100%">
                <div class="container" style="width:100% ; height:510px ; background-color:#EEEEEE; font-size:22px;padding:5px;">
                    <h5 id="DivBlindDetailTitle" style="padding:5px;">גוגל -> חדר 1206 -> וילון (F11 (M</h5>


                    <div id="BR0-1-" class="BRBlind2Details" style="padding-right:70px;padding-top:25px;">

                        <div class="icon solid fa-angle-double-up BRBlind2DetailsIconUp" onclick="ChangeBigBlindPosition(-100); "></div>
                        <div class="icon solid fa-angle-up BRBlind2DetailsIconUp" onclick="ChangeBigBlindPosition(-10); " ></div>

                        <div id="DivMaxHeight" class="Blind2DetailsShow" style="width:70px; height:200px;">
                            <div id="DivMyHeightBackground" style="position:absolute;background-color:#b488d8;height:50px;width:64px;"></div>
                            <div id="DivMyHeightShow" style="position:absolute">50%</div>


                            <div id="mydiv"  onmouse="alert(2);" class="icon solid fa-arrows-alt-v BRBlind2DetailsIconMiddle"> </div>

                        </div>
                        <div class="icon solid fa-angle-down BRBlind2DetailsIconUp"  onclick="ChangeBigBlindPosition(10); " ></div>
                        <div class="icon solid fa-angle-double-down BRBlind2DetailsIconUp"  onclick="ChangeBigBlindPosition(100); " ></div>

                    </div>
                    <h4></h4>
                    <h4></h4>

                    <div id="container22">
                        <div class="slide one"></div>
                    </div>


                    <div id="DivBlindDetailErrorContainer" style="margin-top:10px">
                        <div id="DivBlindDetailError" class="icon solid fa-exclamation-triangle BRBlind2exclamation" style="font-size:17px;"></div>
                        <div id="DivBlindDetailErrorText" style="display:inline-flex"></div>

                            
                        </div>
                        <ul class="actions" style="padding-top:30px;display:none">

                            <li><a href="#contactMe"> <input type="button" class="primary button123" value="דווח על תקלה" /></a></li>
                            <li><input type="reset" class="primary button123" value="כייל וילון" /></li>

                        </ul>
                    </div>

            </article>

            <article id="work2" class="panel">
                <header>
                    <h1>Jane Doe</h1>
                    <p>Senior Astral Projectionist</p>
                </header>
                <a href="#work" class="jumplink pic">
                    <span class="arrow icon solid fa-chevron-right"><span>See my work</span></span>
                    <img src="images/me.jpg" alt="" />
                </a>
            </article>

            <!-- Login -->
            <article id="Login" class="panel spacing">
                <div class="container">
                    <h1 class="H1Title" style="margin-bottom: 20px;">התחברות למערכת</h1>
                    <form method="post" action="#">
                        <div class="formInput"><i class="icon fa fa-user-circle"></i><input class="col-12 col-12-xsmall user" type="text" name="name" id="name" placeholder="User"/></div>
                        <div class="formInput"><i class="icon-alan icon-unlock"></i><input class="col-12 col-12-xsmall password" type="password" name="email" id="email" placeholder="Password"/></div>
                        <div class="formInput">
                            <span>Remember me</span><input type="checkbox"/><label for="ChkActive"><span></span></label>
                        </div>
                        <div class="formInput"><a href="#">?Forgot your Password</a></div>
                        <div class="formInput" style="margin-bottom: 10px">
                            <input type="button" class="primary button123" value="LOGIN" />
                        </div>
                    </form>
                </div>
            </article>

            <article id="contact" class="panel spacing">
                <div class="container" dir="rtl">
                    <h1 class="H1Title">הודעות</h1>
                    <div class="feature-icons">
                        <div class="message wow fadeInUp center open">
                            <i class="icon solid fa-envelope-open"></i>
                            <span>20/06/2019 - פניתך למערכת נקלטה בהצלחה</span>
                        </div>
                        <div class="message wow fadeInUp center">
                            <i class="icon solid fa-envelope"></i>
                            <span>16/06/2019 - ברוך הבא למערכת</span>
                        </div>
                        <div class="message wow fadeInUp center">
                            <i class="icon solid fa-envelope"></i>
                            <span>16/06/2019 - ברוך הבא למערכת</span>
                        </div>
                        <div class="message wow fadeInUp center">
                            <i class="icon solid fa-envelope"></i>
                            <span>16/06/2019 - ברוך הבא למערכת</span>
                        </div>
                        <div class="message wow fadeInUp center">
                            <i class="icon solid fa-envelope"></i>
                            <span>16/06/2019 - ברוך הבא למערכת</span>
                        </div>
                        <div class="message wow fadeInUp center">
                            <i class="icon solid fa-envelope"></i>
                            <span>16/06/2019 - ברוך הבא למערכת</span>
                        </div>
                        <div class="message wow fadeInUp center">
                            <i class="icon solid fa-envelope"></i>
                            <span>16/06/2019 - ברוך הבא למערכת</span>
                        </div>
                        <div class="message wow fadeInUp center">
                            <i class="icon solid fa-envelope"></i>
                            <span>16/06/2019 - ברוך הבא למערכת</span>
                        </div>
                        <div class="message wow fadeInUp center">
                            <i class="icon solid fa-envelope"></i>
                            <span>16/06/2019 - ברוך הבא למערכת</span>
                        </div>
                        <div class="message wow fadeInUp center">
                            <i class="icon solid fa-envelope"></i>
                            <span>16/06/2019 - ברוך הבא למערכת</span>
                        </div>
                        <div class="message wow fadeInUp center">
                            <i class="icon solid fa-envelope"></i>
                            <span>16/06/2019 - ברוך הבא למערכת</span>
                        </div>
                        <div class="contactLogo">
                            <img src="./images/logo.png"/>
                        </div>
                    </div>
                </div>
            </article>


            <article id="Rules" class="panel">
                <div class="container" dir="rtl">
                    <h1 class="H1Title">חוקים</h1>
                    <table class="rules">
                        <tr>
                            <th>שם</th>
                            <th>הפעל</th>
                            <th>מצב</th>
                        </tr>
                        <tr>
                            <td> <a href="#Rules2"> דגל ישראל </a></td>
                            <td>
                                <div class="icon solid2 fa-toggle-off BRBlind2RuletoggleOff"></div>
                            </td>
                            <td>
                                <div class="icon solid2 fa-power-off BRBlind2RulePowerOff"></div>
                            </td>
                        </tr>
                        <tr>
                            <td>הורד כל הוילונות</td>
                            <td>
                                <div class="icon solid2 fa-toggle-off BRBlind2RuletoggleOff"></div>
                            </td>
                            <td>
                                <div class="icon solid2 fa-power-off BRBlind2RulePowerOff"></div>
                            </td>
                        </tr>
                        <tr>
                            <td>הרם כל הוילנות</td>
                            <td>
                                <div class="icon solid2 fa-toggle-off BRBlind2RuletoggleOff"></div>
                            </td>
                            <td>
                                <div class="icon solid2 fa-power-off BRBlind2RulePowerOff"></div>
                            </td>
                        </tr>
                        <tr>
                            <td>העבר את כולם לאוטומט</td>
                            <td>
                                <div class="icon solid2 fa-toggle-on BRBlind2RuletoggleOn"></div>
                            </td>
                            <td>
                                <div class="icon solid2 fa-power-off BRBlind2RulePowerOff"></div>
                            </td>
                        </tr>
                        <tr>
                            <td>העבר את כולם למצב ידני</td>
                            <td>
                                <div class="icon solid2 fa-toggle-on BRBlind2RuletoggleOn"></div>
                            </td>
                            <td>
                                <div class="icon solid2 fa-power-off BRBlind2RulePowerOn"></div>
                            </td>
                        </tr>
                    </table>
                </div>
            </article>

            <article id="Rules2" class="panel" style="padding-right:5px; padding-left:5px;">
                <div class="container" dir="rtl" style="height:450px ; font-size:20px; ">
                    <h1 class="H1Title">פרטי חוק</h1>

                    <table>
                        <tr>
                            <th style="text-align:right;">שם</th>
                            <th>הפעל</th>
                            <th>מצב</th>
                        </tr>

                        <tr>
                            <td>דגל ישראל</td>
                            <td style="text-align:center">
                                <div class="icon solid2 fa-power-off BRBlind2RulePowerOff"></div>
                            </td>
                            <td style="text-align:center">
                                <div class="icon solid2 fa-toggle-off BRBlind2RuletoggleOff"></div>
                            </td>
                        </tr>
                    </table>


                    <h1 class="H1Title">שעות</h1>
                    <table>
                        <tr>
                            <th style="text-align:right;">שעות</th>
                            <th style="text-align:right;">א</th>
                            <th style="text-align:right;">ב</th>
                            <th style="text-align:right;">ג</th>
                            <th style="text-align:right;">ד</th>
                            <th style="text-align:right;">ה</th>
                            <th style="text-align:right;">ו</th>
                            <th style="text-align:right;">ש</th>
                        </tr>

                        <tr>
                            <td>06:00 - 20:00</td>
                            <td> V</td>
                            <td> V</td>
                            <td> V</td>
                            <td> V</td>
                            <td> V</td>
                            <td> _</td>
                            <td> _</td>
                        </tr>
                    </table>
                </div>

            </article>            <!-- Contact -->
            <article id="contactMe" class="panel">
                <header>
                    <h2>דיווח על תקלה</h2>
                </header>
                <form action="#" method="post">
                    <div>
                        <div class="row">
                            <div class="col-6 col-12-medium">
                                <input type="text" name="name" placeholder="שם: פריאל חקק" />
                            </div>
                            <div class="col-6 col-12-medium">
                                <input type="text" name="email" placeholder="טלפון: 0524618476" />
                            </div>
                            <div class="col-12">
                                <input type="text" name="subject" placeholder="נושא: תקלה בוילון F11" />
                            </div>
                            <div class="col-12">
                                <textarea name="message" placeholder="פרטים" rows="6"></textarea>
                            </div>
                            <div class="col-12">
                                <input type="submit" value="שלח" class="button123" />
                            </div>
                        </div>
                    </div>
                </form>
            </article>

        </div>

        <!-- Footer -->
        <!--div id="footer" style="font-size:15px; padding-top:30px;">
            <ul class="copyright">
                <li>כל הזכויות שמורות: <a href="http://www.arbicom.co.il">ארביקום בע"מ </a></li>
                <li>&copy;.</li>

            </ul>
        </div-->

    </div>

    <!-- Scripts -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/browser.min.js"></script>
    <script src="assets/js/breakpoints.min.js"></script>
    <script src="assets/js/util.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="assets/js/wow.min.js"></script>
    <script>
         new WOW().init();

        //Make the DIV element draggagle:
        dragElement(document.getElementById("mydiv"));

        function dragElement(elmnt) {
            var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            if (document.getElementById(elmnt.id + "header")) {
                /* if present, the header is where you move the DIV from:*/
                document.getElementById(elmnt.id + "header").onmousedown = dragMouseDown;
            } else {
                 
                /* otherwise, move the DIV from anywhere inside the DIV:*/
                elmnt.onmousedown = dragMouseDown;
            }
            
            function dragMouseDown(e) {
                e = e || window.event;
                e.preventDefault();
                // get the mouse cursor position at startup:
                pos3 = e.clientX;
                pos4 = e.clientY;
                document.onmouseup = closeDragElement;
                // call a function whenever the cursor moves:
                document.onmousemove = elementDrag;
            }

            function elementDrag(e) {
                e = e || window.event;
                e.preventDefault();
                // calculate the new cursor position:
                pos1 = pos3 - e.clientX;
                pos2 = pos4 - e.clientY;
                pos3 = e.clientX;
                pos4 = e.clientY;

                var BorderTop = 70;// offset(document.getElementById("DivMaxHeight")).top;
                var BorderHeight = document.getElementById("DivMaxHeight").style.height.replace('px', '');
                var CurHeight = elmnt.offsetTop - pos2;
                if (CurHeight < BorderTop)
                    CurHeight = BorderTop;

                var MaxHeight = 235;//Number(Number(BorderTop) + (Number(BorderTop)))
                if (CurHeight > MaxHeight)
                    CurHeight = MaxHeight;

                // set the element's new position:
                elmnt.style.top = (CurHeight) + "px";
                var CurPer = Math.round((((CurHeight - 70) * 100) / 165));
                PresentBigBlindPosition(CurPer);
                selectedPosition = CurPer;
            }

            function offset(el) {
                var rect = el.getBoundingClientRect(),
                    scrollLeft = window.pageXOffset || document.documentElement.scrollLeft,
                    scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                return { top: rect.top + scrollTop, left: rect.left + scrollLeft }
            }


            function closeDragElement() {
                /* stop moving when mouse button is released:*/
                document.onmouseup = null;
                document.onmousemove = null;
                debugger;
                ActivateDevice(3, 4, selectedCardVersion, selectedCardId, ';FldBlindPositionUser,' + selectedPosition);

            }
        }



        window.onload = function () {
            // find the element that you want to drag.
            var box = document.getElementById('mydiv');

            /* listen to the touchMove event,
            every time it fires, grab the location
            of touch and assign it to box */

            box.addEventListener('touchmove', function (e) {
                // grab the location of touch
                var touchLocation = e.targetTouches[0];
                var pos2 = touchLocation.pageY;

                // assign box new coordinates based on the touch.
                //box.style.left = touchLocation.pageX + 'px';
                var BorderTop = 70;// offset(document.getElementById("DivMaxHeight")).top;
                var BorderHeight = document.getElementById("DivMaxHeight").style.height.replace('px', '');
                var CurHeight = pos2 - BorderTop;

                if (CurHeight < BorderTop)
                    CurHeight = BorderTop;

                var MaxHeight = 235;//Number(Number(BorderTop) + (Number(BorderTop)))
                if (CurHeight > MaxHeight)
                    CurHeight = MaxHeight;

                // set the element's new position:
                box.style.top = (CurHeight) + "px";


                var CurPer = Math.round((((CurHeight - 70) * 100) / 165));
                PresentBigBlindPosition(CurPer);
                selectedPosition = CurPer;

                // box.style.top = touchLocation.pageY + 'px';
            })

            /* record the position of the touch
            when released using touchend event.
            This will be the drop position. */

            box.addEventListener('touchend', function (e) {
                //alert(1);
                ActivateDevice(3, 4, selectedCardVersion, selectedCardId, ';FldBlindPositionUser,' + selectedPosition);

                /*// current box position.
                var x = parseInt(box.style.left);
                var y = parseInt(box.style.top);
                */
            })

        }
    </script>
    <script>
        var positionpop = 80;
        var angle = 70;
        window.onload = function() {
            changeClass();
            $("#slideAngle").val(100-angle);
            $("#slidePosition").val(100-positionpop);
            $("#slideAngle").on('input', function(){
                angle = 100 - this.value
                changeClass();
            }); 
            $("#slidePosition").on('input', function(){
                positionpop = 100 - this.value + 1
                console.log(positionpop);
                changeClass();
            });
        };
        $("#blindExample").on('click', function(){
            blindClick("blindExample")
        });
        function changeClass(otherClass = "") {
            var element = document.getElementById("blindDetailContent");
            element.className = "position" + positionpop + " " + "angle" + angle + " " + otherClass;
            $("#slideAngle").val(100-angle);
            $("#slidePosition").val(100-positionpop);
            //$("#blindpopPosition").innerHTML  = positionpop + "%";
            document.getElementById("blindpopPosition").innerHTML = positionpop + "%";
            console.log(position);

        } 
    </script>
</body>
</html>